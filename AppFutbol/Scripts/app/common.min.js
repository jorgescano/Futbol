var viewManagement=viewManagement||{};viewManagement.common={dataBase:null,readDataBase:function(n){fetch("~/Models/players.json").then(n=>n.json()).then(t=>{viewManagement.common.dataBase.Players=t,fetch("~/Models/matches.json").then(n=>n.json()).then(t=>{viewManagement.common.dataBase.Matches=t,n&&{}.toString.call(n)==="[object Function]"&&n()}).catch(n=>{console.log("Error loading database"),console.error(n)})}).catch(n=>{console.log("Error loading database"),console.error(n)})},saveDataBase:function(){var t=document.createElement("a"),i=new Blob([JSON.stringify(viewManagement.common.dataBase.Players,null,4)],{type:"application/json"}),n;t.href=URL.createObjectURL(i);t.download="players_new.json";t.click();n=document.createElement("a");i=new Blob([JSON.stringify(viewManagement.common.dataBase.Matches)],{type:"application/json"});n.href=URL.createObjectURL(i);n.download="matches_new.json";n.click()},getPlayers:function(){if(areaMng.isNullOrEmpty(viewManagement.common.dataBase))return[];var n=JSON.parse(JSON.stringify(viewManagement.common.dataBase.Players)),t=JSON.parse(JSON.stringify(viewManagement.common.dataBase.Matches));return n.forEach(n=>{t.forEach(t=>{var r=t.LocalPlayers.find(t=>t.Id==n.Id),u=t.AwayPlayers.find(t=>t.Id==n.Id),i=viewManagement.common.isNullOrEmpty(r)?u:r;if(!viewManagement.common.isNullOrEmpty(i)){n.Goals+=i.Goals;n.Assists+=i.Assists;viewManagement.common.isNullOrEmpty(i.PenaltiesSaved)||(n.PenaltiesSaved+=i.PenaltiesSaved);let f=viewManagement.common.isNullOrEmpty(r)?"away":"local",u=null;t.LocalScore>t.AwayScore?u="local":t.LocalScore<t.AwayScore&&(u="away");viewManagement.common.isNullOrEmpty(u)?n.Draws+=1:f==u?n.Wins+=1:n.Defeats+=1}t.MVP==n.Id&&(n.MVPs+=1)}),n.Matches=n.Wins+n.Draws+n.Defeats,n.GoalsAverage=n.Goals==0||n.Matches==0?"0.00":(n.Goals/n.Matches).toFixed(2),n.AssistsAverage=n.Assists==0||n.Matches==0?"0.00":(n.Assists/n.Matches).toFixed(2)}),n},getMatches:function(){if(areaMng.isNullOrEmpty(viewManagement.common.dataBase))return[];var t=JSON.parse(JSON.stringify(viewManagement.common.dataBase.Players)),n=JSON.parse(JSON.stringify(viewManagement.common.dataBase.Matches));return n.forEach(n=>{n.Date=viewManagement.common.stringToDate(n.Date),n.LocalPlayers.concat(n.AwayPlayers).forEach(n=>{var i=t.find(t=>t.Id==n.Id);viewManagement.common.isNullOrEmpty(i)||(n.Name=i.Name)})}),n},toggleDarkMode:function(){let n=$("#switch-theme").prop("checked");n?$("body").addClass("dark-mode"):$("body").removeClass("dark-mode");localStorage.setItem("darkTheme",JSON.stringify(n))},setHref:function(n){window.location.href.indexOf(n)==-1?window.location.href=n:$(window).scrollTop(0)},isNullOrEmpty:function(n){return n==null||n==undefined?!0:typeof n=="string"&&n.trim()==""?!0:n.length==0?!0:!1},days:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],stringToDate:function(n){if(viewManagement.common.isNullOrEmpty(n))return null;var i=n,t=i.split("/");return new Date(+t[2],t[1]-1,+t[0])},dateToString:function(n){if(viewManagement.common.isNullOrEmpty(n))return null;let r=viewManagement.common.days[n.getDay()],t=n.getDate(),i=n.getMonth()+1,u=n.getFullYear();return t<10&&(t=`0${t}`),i<10&&(i=`0${i}`),`${r} ${t}-${i}-${u}`},sortByProperty:function(n,t,i){return viewManagement.common.isNullOrEmpty(n)||viewManagement.common.isNullOrEmpty(t)?n:i?n.sort((n,i)=>n[t]>i[t]?-1:i[t]>n[t]?1:0):n.sort((n,i)=>n[t]>i[t]?1:i[t]>n[t]?-1:0)},sortByProperties:function(n,t,i,r,u){if(viewManagement.common.isNullOrEmpty(n)||viewManagement.common.isNullOrEmpty(t)||viewManagement.common.isNullOrEmpty(i))return n;var f=r?1:-1,e=r?-1:1,o=u?f:-1,s=u?e:1;return n.sort((n,r)=>n[t]<r[t]?f:n[t]>r[t]?e:n[i]<r[i]?o:n[i]>r[i]?s:0)}};$(document).ready(function(){let n=viewManagement.common,t=localStorage.getItem("darkTheme");if(!n.isNullOrEmpty(t)){let i=JSON.parse(t);$("#switch-theme").prop("checked",i!=!1);n.toggleDarkMode(i)}});